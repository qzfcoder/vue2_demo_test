<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
	   <link href="../css/scene.css" rel="stylesheet" type="text/css" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<script type="text/javascript" src="../res/suwell_ofdReader.js" charset="UTF-8" ></script>

	    <link href="../jquery-easyui-1.4.4/themes/default/easyui.css" rel="stylesheet" type="text/css" />
        <link href="../jquery-easyui-1.4.4/themes/icon.css" rel="stylesheet" type="text/css" />
        <script src="../jquery-easyui-1.4.4/jquery.min.js" type="text/javascript"></script>
        <script src="../jquery-easyui-1.4.4/jquery.easyui.min.js" type="text/javascript"></script>

		<title>场景3：打开可控阅读服务上的文件</title>
		<script>
		var ocx;
			function initObject()
			{

			  if(window.console)
				   window.console.log("initObject()");
				else  
				   alert("initObject()");

			   //注意：插件宽高设固定值。
				ocx = suwell.ofdReaderInit("OFDActiveXDIV","700px","600px");
				  if(ocx){
                   ocx.registListener("f_open","openPerformed",true);
				}
			
			}

		function openPerformed(type,param,param0){
				alert(type+":"+param+":"+param0);

		}


        //打开可控内容服务文件。
        function openFile(){
		   var userID=document.getElementById("userId").value;

		  	ocx.setUserID(userID);


		  var path=document.getElementById("url").value;

		  var docId=document.getElementById("docId").value;
          ocx.openSvcFile(path,docId);
		}


   

			</script>
    </head>
    <body onload="initObject();">

  <div class="list"><b> </b>	

    <p >  1.打开版式页面，并在插件准备好后调用setUserId设置当前用户信息。</p><br/>
    <p >  UserId:	<input type="text"  size="50" id="userId" /></p><br/>

    <hr/>


	<p >  2.调用openSvcFile，参数svcAddr指向内容服务地址，docId是文档的唯一标识。</p><br/>
	<p > svcAddr:<br/>	<input type="text"  size="50" id="url" value="http://172.16.14.43:8080/cpcns-content-server/ofd/sc"/></p><br/>
	<p > docId:<br/>	<input type="text"  size="50" id="docId" /></p><br/>
	<p style="width:80px;"></p> <p style="width:50px;"><input type="button" value="打开" onclick="openFile()" class="btn1"></p>

	 <hr/>

     
</div>

	


   	<div id="OFDActiveXDIV" style="float:left;" ></div>
    </body>
    </html>
 
    