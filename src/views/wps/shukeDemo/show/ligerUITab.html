<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title></title>
    <link href="../jquery-ligerUI/ligerUI/skins/Aqua/css/ligerui-all.css" rel="stylesheet" type="text/css" />
    <script src="../jquery-ligerUI/jquery/jquery-1.9.0.min.js" type="text/javascript"></script>
    <script src="../jquery-ligerUI/ligerUI/js/core/base.js" type="text/javascript"></script>
    <script src="../jquery-ligerUI/ligerUI/js/plugins/ligerTab.js" type="text/javascript"></script>
    <script src="../res/suwell_ofdReader.js" type="text/javascript"></script>
    <script type="text/javascript">

		var ocx;
        $(function ()
        {
         $("#navtab1").ligerTab({


   
			  onBeforeSelectTabItem:function(tabid){
			if (tabid == 'tabitem2') {
									   
				
					changeDiv2();
									}
			 else if (tabid == 'tabitem3'||tabid =='tabitem1') {
				  changeDiv1();

			 }

			},

             onAfterSelectTabItem : function(tabid){
                        if (tabid == 'tabitem1') {
                           //IE放开下面的方法
							// onCloseAll();
                        }
                        else if (tabid == 'tabitem2') {
				
                         //IE放开下面的方法
							// onCloseAll();

                        }
                        else if (tabid == 'tabitem3') {
				
                            //IE放开下面的方法
							// onCloseAll();
                    }
                   }
            });

        });

	

        function ocxLoad(div, ofd) {
		
				 ocx = suwell.ofdReaderInit(div,"auto","auto");
				 ocx.openFile("C:\\Users\\Administrator\\Desktop\\我是方正小标宋简体3.ofd", true);
		
        }


		function changeDiv1(){
       	if($("#OFDDIV2").html()!=null&&("##OFDDIV2").html!=""){
                             var oldofdDiv= $("#OFDDIV2")[0];
							 var newofdDiv=document.adoptNode(oldofdDiv);
							 $(newofdDiv).find("embed").height(1);
							 $("#OFDCloneDiv").append(newofdDiv);
							 }           

		}

		function changeDiv2(){
       	if($("#OFDCloneDiv").html()!=null&&("#OFDCloneDive").html!=""){
                             var oldofdDiv= $("#OFDDIV2")[0];
							 var newofdDiv=document.adoptNode(oldofdDiv);
							 $(newofdDiv).find("embed").height(722);
							 $("#Div2").append(newofdDiv);
							 }

		}
    </script>
</head>
<body style="padding:10px" onload="ocxLoad('OFDDIV2','')">
<div id="navtab1" style="width: 600px;overflow:hidden; border:1px solid #A3C0E8; ">
    <div  title="我的主页1" showClose="true" id="t1">
	 <div id="Div1" style="margin:10px;height:300px;">
       &nbsp;&nbsp;tab切换采用display:none属性，火狐浏览器使用该属性后，<br/>
	   HTML元素（对象）的宽度、高度等各种属性值都会得到销毁指令。 <br/>
	   数科插件也会被销毁，已打开的文件会被关闭。再切换回插件tab时文件无法再次打开。 <br/>
	   &nbsp;&nbsp;此前有用户通过每次切换tab页都进行插件的初始化<br/>
	   并打开文档来实现需求，但是经测试偶尔导致浏览器崩溃。<br/>

	   我方建议如下：<br/>
	   1）只初始化一次插件<br/>
	   2）切换时文件关闭的问题，用div剪切回贴的方法解决。<br/>
	   此方法的即可避免多次初始化插件导致浏览器崩溃，又可使文件保持阅读状态。<br/>
       详见代码示例。切换tab2可看效果。
</div>

    </div>
    <div  title="我的主页2"  showClose="true" id="t2">
        <div id="Div2" style="margin:10px;height:300px;"><div id="OFDDIV2"></div></div>
    </div>
    <div  title="我的主页3" showClose="true" id="t3">
       	 <div id="Div3" style="margin:10px;height:300px;"></div>
    </div>
</div>
<!--
<input type="button" value="切换走" onclick="changeDiv1()"/>

<input type="button" value="切换回" onclick="changeDiv2()"/>
-->

<div id="OFDCloneDiv" style="width:1px;height:1px;background-color:#3f3f3f;position:absolute;top:10px;left:10px;">

</div>

</body>
</html>
