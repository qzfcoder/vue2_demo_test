<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<head>
		<title>title</title>
	</head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<style>
	* {
		margin: 0;
		padding: 0;
	}
	button {
	    background: #17a086;
		color: #fff;
		padding: 5px;
		outline: none;
		border: 1px solid transparent;
		border-radius: 5px;
		font-size: 13px;
		margin-bottom: 5px;
	}
	</style>
	<body>
		<div id="doc" align="left" style="position:inherit">
			<button onclick="InitFrame()">初始化插件</button>	
			<button onclick="createDocument()">创建新文档</button>
            <button onclick="Bulid()">获取版本</button>
            <button onclick="getPluginVersion()">获取插件版本号</button>
			<button onclick="FullScreen()">全屏</button>
			<button onclick="openDocumentF()">可编辑打开本地文档</button>
            <button onclick="openDocumentF2()">可编辑打开本地文档_通过本地文件对话框选择文件的方式打开</button>
			<button onclick="openDocumentT()">只读模式打开本地文档</button>
			<button onclick="openDocumentRemote()">打开远程文档</button>
            <button onclick="saveURL_s()">保存到远程不落地_保存当前打开的文档</button>
			<button onclick="openDocumentRemote_s()">打开远程文档不落地</button>
            <button onclick="saveAsBase64Str()">保存到base64</button>
			<button onclick="openDocumentFromBase64Str()">从base64打开</button>
            <button onclick="saveURL()">保存到远程_保存当前打开的文档</button>
            <button onclick="saveURL2()">保存到远程_保存为pdf并加密</button>
            <button onclick="saveURL3()">保存到远程_保存成pdf并设置是否导出文档信息</button>
            <button onclick="saveURL4()">保存到远程_导出ofd嵌入字体</button>
            <button onclick="SendDataToServer()">本地文档保存到远程</button>
            <button onclick="DownLoadServerFile()">下载</button>
			<button onclick="saveAsQ()">保存本地不弹框</button>
			<button onclick="saveAs()">保存本地弹框</button>
			<button onclick="closewps()">关闭文档</button>
			<button onclick="disable_ctrl_p()">禁用ctrl+p</button>
			<button onclick="enable_ctrl_p()">启用ctrl+p</button>
			<button onclick="printwps()">打印文档</button>
			<!-- <button onclick="setToolbarAllVisibleT()">显示工具条</button>
			<button onclick="setToolbarAllVisibleF()">隐藏工具条</button> -->
			<button onclick="insertPicture()">当前光标处插入图片</button>
            <button onclick="insertPicture2()">当前光标处插入图片_浮于文字上方</button>
			<button onclick="insertPictureSize()">插入图片_带尺寸坐标</button>
			<button onclick="getText()">获取文本内容</button>
			<button onclick="setUserName()">设置审批用户名</button>
			<button onclick="getUserName()">获取审批用户名</button>
            <button onclick="enableRevisionStart()">开启修订</button>
			<button onclick="enableRevisionEnd()">停止修订</button>
			<button onclick="showRevision0()">显示标记的原始修订</button>
			<button onclick="showRevision1()">显示原始修订</button>
			<button onclick="showRevision2()">显示最终修订</button>
			<button onclick="printRevision0()">打印修订</button>
			<button onclick="printRevision1()">打印原始修订</button>
			<button onclick="printRevision2()">打印最终修订</button>
            <button onclick="enableRevisionAcceptCommand()">禁止接受修订按钮</button>
			<button onclick="enableRevisionRejectCommand()">禁止拒绝修订按钮</button>
			<button onclick="enableProtectT()">保护文档</button>
			<button onclick="enableProtectF()">停止保护</button>	
			<button onclick="enableCut()">禁止剪切</button>
			<button onclick="enableCopy()">禁止复制</button>
			<button onclick="ExportToOfd()">本地导出ofd</button>
			<button onclick="insertDocumentField()">插入一个公文域</button>
            <button onclick="insertDocumentFieldMultiField()">插入多个公文域</button>	
			<button onclick="ShowDocumentFieldTarget1()">隐藏公文域底纹_函数调用方式</button>
			<button onclick="ShowDocumentFieldTarget2()">隐藏公文域底纹_属性调用方式</button>	
			<button onclick="get_ShowDocumentFieldTarget()">判断公文域底纹是否存在</button>
			<button onclick="getAllDocumentField()">获取公文域列表</button>	
			<button onclick="deleteDocumentField()">公文域删除</button>		
			<button onclick="showDocumentField()">公文域显示</button>			
			<button onclick="showDocumentField2()">公文域不显示</button>			
			<button onclick="getDocumentFieldValue()">查询公文域内容</button>			
			<button onclick="enableDocumentField()">公文域可编辑</button>	
			<button onclick="enableDocumentField2()">公文域不可编辑</button>	
			<button onclick="insertDocument()">公文域插入文档内容</button>
			<button onclick="insertDocument2()">公文域插入文档内容_ftp</button>
			<button onclick="isExists()">判断公文域是否存在</button>	
			<button onclick="backspace()">删除</button>
			<button onclick="cursorToDocumentField()">光标移动到公文域指定位置</button>
            <button onclick="cursorToDocumentField5()">光标选中指定公文域</button>	
			<button onclick="insertText()">光标位置插入文本</button>	
			<button onclick="setDocumentId()">设置公文标识</button>	
			<button onclick="getDocumentId()">获取公文标识</button>		
			<button onclick="setDocumentType()">设置文种</button>	
			<button onclick="getDocumentType()">获取文种</button>
			<button onclick="showDocumentMultiField()">隐藏多个公文域</button>
			<button onclick="deleteDocumentMultiField()">删除多个公文域</button>
			<button onclick="setDocumentField1()">修改公文域内容</button>
			<button onclick="setDocumentField2()">修改公文域内容_除正文</button>
            <button onclick="fileVisible()">隐藏文件菜单</button>
            <button onclick="menuvisible()">隐藏输出ofd和pdf按钮</button>
            <button onclick="ClipboardRegister()">复制监听</button>
            <button onclick="put_PrintDrawingObjects()">设置打印图形对象</button>      
            <button onclick="put_PrintHiddenText()">设置打印隐藏文字</button>
            <button onclick="put_PrintHiddenTextMode1()">设置打印隐藏文字模式1_不打印</button>
            <button onclick="put_PrintHiddenTextMode2()">设置打印隐藏文字模式2_打印</button>
            <button onclick="put_PrintHiddenTextMode3()">设置打印隐藏文字模式3_套打</button>
            <button onclick="setOfdServiceProviderSuwell()">ofd厂商设置为Suwell</button>
	        <button onclick="setServiceProviderFoxit()">ofd厂商设置为Foxit</button>
			<button onclick="RegisterBeforeCloseEvent()">注册关闭事件</button>
            <button onclick="UnRegisterBeforeCloseEvent()">取消注册关闭事件</button>
            <button onclick="Addbutton()">添加一个按钮</button>
            <button onclick="RegisterCommandbar()">注册按钮事件</button>
            <button onclick="UnRegisterCommandbar()">取消注册按钮事件</button>
            <button onclick="getFileSize()">获取文件大小</button>
			<button onclick="setForceBackUpEnabled2()">开启自动备份</button>	
            <button onclick="setForceBackUpEnabled1()">关闭自动备份</button>	
            <button onclick="Inserttable()">插入表格</button>
            <button onclick="handwritting_unvisable()">隐藏手写签批</button>
            <button onclick="FitText()">适应文字1_选定区域的单元格</button>
            <button onclick="FitText2()">适应文字2_公文域所在单元格</button>
			<button onclick="EnterInkDraw()">进入手写批注状态</button>
			<button onclick="ExitInkDraw()">退出手写批注状态</button>	
			<button onclick="SetInkDrawColor()">设置当前批注颜色</button>
			<button onclick="SetInkDrawStyle1()">设置使用笔</button>
			<button onclick="SetInkDrawStyle2()">设置使用形状</button>
			<button onclick="SetInkDrawShapeStyle1()">设置批注形状类型_直线</button>
			<button onclick="SetInkDrawShapeStyle2()">设置批注形状类型_波浪线</button>
			<button onclick="SetInkDrawShapeStyle3()">设置批注形状类型_矩形</button>
			<button onclick="SetInkDrawPenStyle1()">设置批注笔类型_圆珠笔</button>
			<button onclick="SetInkDrawPenStyle2()">设置批注笔类型_水彩笔</button>
			<button onclick="SetInkDrawPenStyle3()">设置批注笔类型_荧光笔</button>
			<button onclick="SetInkDrawLineStyle1()">设置批注磅值_0.25</button>
			<button onclick="SetInkDrawLineStyle2()">设置批注磅值_4</button>
			<button onclick="SetInkDrawLineStyle3()">设置批注磅值_8</button>
			<button onclick="SetInkDrawEraser()">进入橡皮擦状态</button>
			<button onclick="SetInkDrawEraser2()">退出橡皮擦状态</button>
         	<button onclick="InsertImageFromScanner()">插入图片来自扫描仪</button>
			<button onclick="RegisterDocumentBrforeSaveEvent()">注册保存监控事件</button> 
			<button onclick="CommandBarsT()">显示转换按钮</button>
			<button onclick="CommandBarsF()">隐藏转换按钮</button>
			<button onclick="Documents()">打开隐藏文档</button>  	  			
			<button onclick="retitle1()">设置标题行重复</button>
			<button onclick="retitle2()">取消标题行重复</button>
			<button onclick="insertMultiBookMarks()">批量插入书签</button>
			<button onclick="deleteMultiBookMarks()">批量删除书签</button>
			<button onclick="getAllBookMarks()">获取全部书签</button>
			<button onclick="replaceBookMarksText()">替换书签内容</button>
			<button onclick="saveURL_GetData()">保存到远程_返回自定义标识</button>
			<button onclick="RegisterSaveEvent()">注册只读文档另存后的文档为可编辑状态</button>
			<button onclick="SplitRow()">按行拆分</button>
			<button onclick="SplitColumn()">按列拆分</button>
			<button onclick="SplitCell()">拆分单元格</button>

			
		</div>

  		 <div id="wps" align="right" style="width:70%; height:100%; left:400px; position:absolute">
		</div>
  
	</body>
</html>

<script type="text/javascript">	
	//obj = document.getElementById("webwps_id");
	var obj = null;
	var app;
	var documentTmp;

	function init(tagID, w, h) {
		var iframe;
		var obj;

		iframe = document.getElementById(tagID);
		iframe.innerHTML = '';
		var codes = [];
		codes.push(
			"<object  name='webwps' id='webwps_id' type='application/x-wps' width='100%' height='100%'> <param name='Enabled' value='1' />  </object>"
		);

		iframe.innerHTML = codes.join("");
		obj = document.getElementById("webwps_id");

		window.onbeforeunload = function () {
			obj.Application.Quit();
		};

		window.onresize = function () {
			console.log("ondrag");
			obj.sltReleaseKeyboard();
		};
		console.log(obj);
		return obj.Application;
	}

	function InitFrame() {
		app = init("wps", "100%", "100%");
		// console.log(app);
		// if (!app) {
		// 	console.log('初始化插件失败！！！');
		// }
		// else {
			createDocument();
		// }
	}

	function createDocument()
	{
		console.log(app);
		obj.EnterEditMode();//解决新建之后立马能输入 QuitEditMode  sltReleaseKeyboard
		app.createDocument("wps");
	}
	function openDocumentF()
	{
		var aa = app.openDocument("/home/greatwall/桌面/js demo/123.wps", false);
                alert (aa);
	}
    function openDocumentF2()
	{
		var bb = app.ShowLocalDocumentDialog();
		var aa = app.openDocument(bb,false);
        alert (aa);
	}
	function openDocumentT()
	{
		app.openDocument("/home/greatwall/桌面/js demo/123.wps", true);
	}
	function openDocumentRemote()
	{
		var aa = app.openDocumentRemote("http://192.168.39.31:8080/wps/测试.wps", false);
        alert (aa);
	} 
	function saveAsQ()
	{
		var aa =app.saveAs("/home/wps/桌面/001.wps");
		alert (aa);
	}
	function saveAs()
	{
		var aa = app.saveAs();
		alert (aa);
	}
	function saveURL()
	{
		var aa = app.saveURL("http://192.168.39.31:8080/wps/upload_l.jsp", "测试0320.wps" );
        alert (aa);
	}
     function SendDataToServer()
	{
		var aa = obj.SendDataToServer("http://192.168.39.31:8080/wps/upload_l.jsp", "/home/kylin/Desktop/js demo/wps/添加书签.wps", "测试.wps",false);
        alert (aa);
	}
    function DownLoadServerFile()
	{
		var aa = obj.DownLoadServerFile("http://192.168.39.31:8080/wps/测试.wps", "/home/kylin/测试/下载/测试下载.wps");
       alert (aa);
	}
    function saveURL4()
	{
		var aa = app.saveURL("http://192.168.39.31:8080/wps/upload_l.jsp", "测试.ofd", "","",true);
        alert (aa);
	}
    function saveURL2() {
		var name=prompt("请输入要保存的名称","test1.pdf")
		if (name!=null && name!=""){
			var ret = app.saveURL("http://192.168.39.31:8080/wps/upload_l.jsp", name,"aa","bb");
			alert(ret);
		}
		

    }
    function saveURL3() {
   //通过设置ConvertSummaryInfo的值控制是否导出文档信息
    var pdfOptions = app.get_PdfExportOptions(); 
    var ret = pdfOptions.put_ConvertSummaryInfo(false); 
     
   //app.ActiveDocument.Application.PdfExportOptions.ConvertSummaryInfo = false;
	
    
		var name=prompt("请输入要保存的名称","test1.pdf")
		if (name!=null && name!=""){
			var ret = app.saveURL("http://192.168.39.31:8080/wps/upload_l.jsp", name,"aa","bb");
			alert(ret);
		}
		

    }
	function printwps()
	{
		app.print();
	}
	function closewps()
	{
		app.close();
	}
	function setToolbarAllVisibleT()
	{
		var aa = app.setToolbarAllVisible(true);
        alert (aa);
	}
	function setToolbarAllVisibleF()
	{
		var aa = app.setToolbarAllVisible(false);
        alert (aa);
	}
	function enableRevisionStart()
	{
		app.enableRevision(true);
	}
	function enableRevisionEnd()
	{
		app.enableRevision(false);
	}
	function insertPicture()
	{
		var aa = app.insertPicture("/home/wps/桌面/001.wps");
                alert (aa);
	}
    function insertPicture2()
	{
		var aa = app.insertPicture("/home/wps/桌面/001.wps",false);
                alert (aa);
	}
	function insertPictureSize()
	{
		var aa = app.insertPicture("/home/wps/桌面/001.wps", 10, 20, 80, 100);
        alert (aa);
	}
	function getText()
	{
		alert(app.getText());
	}
	function setUserName()
	{
		app.setUserName("shenpiyonghu123");
	}
	function getUserName()
	{
		alert(app.getUserName());
	}
	function showRevision0()
	{
		app.showRevision(0);
	}
	function showRevision1()
	{
		app.showRevision(1);
	}
	function showRevision2()
	{
		app.showRevision(2);
	}
	function printRevision0()
	{
		app.printRevision(0);
	}
	function printRevision1()
	{
		app.printRevision(1);
	}
	function printRevision2()
	{
		app.printRevision(2);
	}
    function enableRevisionAcceptCommand()
	{
		var aa = app.enableRevisionAcceptCommand(false);
        alert (aa);
	}
	function enableRevisionRejectCommand()
	{
		var bb = app.enableRevisionRejectCommand(false);
        alert (bb);
	}
	function enableProtectT()
	{
		app.enableProtect(true);
	}
	function enableProtectF()
	{
		app.enableProtect(false);
	}
	
	function enableCut()
	{
		var aa = app.enableCut(false);
        alert (aa);
	}
	function enableCopy()
	{
		var aa = app.enableCopy(false);
        alert (aa);

	}
	function ExportToOfd()
	{	
		var aa = app.ExportToOfd("/home/wps/桌面/001.ofd");
        alert (aa);
	}
	function insertDocumentField()
	{
		var ret = app.insertDocumentField("wps1");
	
	}
	
        function insertDocumentFieldMultiField()
	{
		app.insertDocumentFieldMultiField("份号,密级,保密期限,紧急程度,后缀标志,发文机关名称,发文顺序号,签发人_1,签发人_2,标题,主送机关,正文,发文机关署名,成文日期,抄送机关_11,抄送机关_12,抄送机关_13,抄送机关_14,抄送机关_15,印发机关,印发日期", "，",",");
		
	}

	function getAllDocumentField()
	{
		var fieldsname = app.getAllDocumentField();
		var strs = new Array();
		strs = fieldsname.split(",");
		alert(strs);
	}
	function deleteDocumentField()
	{
		var ret = app.deleteDocumentField("wps1");
               alert (ret);
	}
	function showDocumentField()
	{
		app.showDocumentField("wps1",true);
	}
	function showDocumentField2()
	{
		app.showDocumentField("wps1",false);
	}
	function getDocumentFieldValue()
	{
		var ret = app.getDocumentFieldValue("wps1");
		alert(ret);
	}
	function enableDocumentField()
	{
		app.enableDocumentField("wps1",true);
	}
	function enableDocumentField2()
	{
		app.enableDocumentField("wps1",false);
	}
	function insertDocument()
	{
		var aa = app.insertDocument("wps1","/home/wps/桌面/001.wps");
        alert (aa);
	}
	function insertDocument2()
	{
		var aa = app.insertDocument("正文","ftp://wps:wpsgch@192.168.39.31/ftp.doc");
        alert (aa);
	}
	function isExists()
	{
		var aa = app.isExists("wps1");
        alert (aa);
	}	
	function backspace()
	{

		app.backspace();
	}
	function cursorToDocumentField()
	{
		app.cursorToDocumentField("wps1",4);
	}
      function cursorToDocumentField5()
	{
		app.cursorToDocumentField("wps1",5);
	}
	function insertText()
	{
		app.insertText("kingsoft");
	}
	function setDocumentId()
	{
		app.setDocumentId("kingsoft");
	}
	function getDocumentId()
	{
		var id = app.getDocumentId();
		alert(id);
	}
	function setDocumentType()
	{
		app.setDocumentType("纪要");
	}
	function getDocumentType()
	{
		var type = app.getDocumentType();
		alert(type);
	}
	function showDocumentMultiField()
	{
		var ret = app.showDocumentMultiField("份号,密级,保密期限,紧急程度,后缀标志,发文机关名称,发文机关代字,年份,发文顺序号,签发人_1,签发人_2,标题,主送机关,正文,发文机关署名,成文日期,抄送机关_1,抄送机关_2,抄送机关_3,抄送机关_4,抄送机关_5,印发机关,印发日期", ",", true);
		alert(ret);
	}
	function deleteDocumentMultiField()
	{
		app.deleteDocumentMultiField("份号,密级,保密期限,紧急程度,后缀标志,发文机关名称,发文机关代字,年份,发文顺序号,签发人_1,签发人_2,标题,主送机关,正文,发文机关署名,成文日期,抄送机关_1,抄送机关_2,抄送机关_3,抄送机关_4,抄送机关_5,印发机关,印发日期",",", true);
	}

	function setDocumentField1()
	{	
		var ret = app.getAllDocumentField();

	var fieldArr = ret.split(",");
		var yus = "";
		var values = "bbbb\n\n";
		for(var i=0;i<fieldArr.length;i++){
			var yu = fieldArr[i];
			if(yu=='正文'){
				values += '正文'
			}else{
			values+=(i+1);
				
			}
			yus+=yu;
			if(i!=fieldArr.length-1){
				yus+="@#_*@";
				values+="@#_*@";
			}
		}
		var aa = app.setDocumentMultiField(yus,values, true);		
              //  alert (aa);
	}
	function setDocumentField2()
	{		
		var ret = app.getAllDocumentField();
		var fieldArr = ret.split(",");
		var yus = "";
		var values = "";
		for(var i=0;i<fieldArr.length;i++){
			var yu = fieldArr[i];
			if(yu=='正文'){
				continue;
			}else{
			values+=(i+100);
				
			}
			yus+=yu;
			if(i!=fieldArr.length-1){
				yus+="@#_*@";
				values+="@#_*@";
			}
		}
		
		var aa = app.setDocumentMultiField(yus,values, true);
               // alert (aa);
		
	}
       function fileVisible()
	   {
		var ret = app.showCommandByName("Menu Bar", 1, false);
		alert(ret);
	   }
       function menuvisible()
       {
        var Bars  = app.get_CommandBars();
	    var filebar = Bars.get_Item("file");
		var spControls = filebar.get_Controls();

		var Controlpdf = spControls.get_Item(25);
		alert(Controlpdf.get_Caption());
		Controlpdf.put_Visible(false);

		var Control = spControls.get_Item(26);
		alert(Control.get_Caption());
		Control.put_Caption("输出为OFD格式(&G)...");
		alert(Control.get_Caption());
		Control.put_Visible(false);

    }

	 function Bulid()
	{
		var ret = app.get_Build();
               // var ret = app.Bulid;
		alert(ret);
	}
	function getPluginVersion()
	{
		var ret = app.getPluginVersion();
               // var ret = app.Bulid;
		alert(ret);
	}

    function Clipboardcallback()
    {
	  alert("Clipboardcallback");
    }
    function ClipboardRegister()
    {

	   obj.ClipbroadCheck();
	   alert(app.registerEvent("DIID_ApplicationEvents4","ClipboardChange", "Clipboardcallback"));
	
    }

    function put_PrintDrawingObjects()
 
	 {
	  	
       var aa = app.Options.put_PrintDrawingObjects(true);
       alert (aa);
	 }
	
	
	  function put_PrintHiddenText()
     {

        var aa = app.Options.put_PrintHiddenText(true);
        alert (aa);
	
     }
	
       function put_PrintHiddenTextMode1()
     {

        var aa = app.Options.put_PrintHiddenTextMode(0);
        alert (aa);
	
     }
       function put_PrintHiddenTextMode2()
     {

        var aa = app.Options.put_PrintHiddenTextMode(1);
        alert (aa);
	
     }
        function put_PrintHiddenTextMode3()
     {

        var aa = app.Options.put_PrintHiddenTextMode(2);
        alert (aa);
	
      }
         function setOfdServiceProviderSuwell()
      {
          var a = app.get_OfdExportOptions();
          var ret = a.put_SelectServiceProvider(0);
          alert(ret);
      }
	     function setServiceProviderFoxit()
	  {
		var a = app.get_OfdExportOptions();
		var ret = a.put_SelectServiceProvider(1);
		alert(ret);
	  }

	     function EventCallBack2(doc,cancel)
	  {
		alert("EventCallBack2");
		cancel.SetValue(true);
		alert(cancel.GetValue());
	  }

	    function RegisterBeforeCloseEvent()
	 {
		var app = obj.Application;
		var ret = app.registerEvent("DIID_ApplicationEvents4","DocumentBeforeClose","EventCallBack2");
		alert("ret--"+ret);
	 }

       function UnRegisterBeforeCloseEvent()
	 {
		var app = obj.Application;
		var ret = app.unRegisterEvent("DIID_ApplicationEvents4","DocumentBeforeClose","EventCallBack2");
		alert("ret--"+ret);
	 }
        function getFileSize(){
		var filename = prompt("请输入文件路径","");
		var saveformat = prompt("请输入文件后缀，为空默认为wps","")
		alert(app.getFileSize(filename,saveformat));
	 }
	
	
	
	function setForceBackUpEnabled1()
	{
		app.setForceBackUpEnabled(false);
	}
       function setForceBackUpEnabled2()
	{
		app.setForceBackUpEnabled(true);
	}
	function FullScreen(){
		app.FullScreen();
	}
		function disable_ctrl_p(){
		app.DisabledHotKeys = "(ctrl+p)";
	}
	function enable_ctrl_p(){
		app.DisabledHotKeys = "";
	}
		function insert_document(){
		alert(app.insertDocument('正文', 'ftp://wps:wpsgch@192.168.39.31/ftp.doc'));
	}
       
      function Addbutton()
      {
		commbar = app.CommandBars.Add("1111",1).Controls.Add(1,1,"1111",1,"1111");
		commbar.put_Visible(true);
		commbar.put_Caption("11111");
	  }


     function RegisterCommandbar()
     {
		
		
		var ret = commbar.registerEvent("DIID__CommandBarButtonEvents","Click","EventCallBack3");
		
		alert("ret--"+ret);
	}
    function UnRegisterCommandbar()
    {
		
		
		var ret = commbar.unRegisterEvent("DIID__CommandBarButtonEvents","Click","EventCallBack3");
		
		alert("ret--"+ret);
	}

      function EventCallBack3()
     {

      alert("这是一个按钮哦");
     }



      function Inserttable()
    {
	  var range = app.ActiveDocument.get_Content();	
	  var table = app.ActiveDocument.Tables.Add(range,3,5);//创建三行五列的表格

	}

      function handwritting_unvisable()
	{

		var Bars = app.get_CommandBars();
		var ReverVing =Bars.get_Item("Reviewing");
 		var reverVingControls = ReverVing.get_Controls();
		alert(reverVingControls);

		var Item = reverVingControls.get_Item(15);
        alert (Item);
		Item.put_Visible(false);

	
	}

      function FitText()
    {

         var aa = app.get_Selection().get_Cells().Item(1).put_FitText(true);
         alert (aa);
	
    }
      function FitText2()
    {

         var aa = app.GetDocumentField("发文机关名称").get_Range().get_Cells().Item(1).put_FitText(true);
	     alert (aa);
    }
		function ShowDocumentFieldTarget1()
	{
	  var bb = app.put_ShowDocumentFieldTarget(false);
	  alert(bb);
       
	}
		function ShowDocumentFieldTarget2()
	{
        var bb = app.ShowDocumentFieldTarget=true;
		alert(bb);
	}
		function get_ShowDocumentFieldTarget()
	{
        var bb = app.get_ShowDocumentFieldTarget();
		alert(bb);
	}
	function openDocumentRemote_s()
	{
		var aa = app.openDocumentRemote_s("http://192.168.39.31:8080/wps/aa不落地测试.docx", false);
        	alert(aa);
	} 
	function saveURL_s()
	{
		var aa = app.saveURL_s("http://192.168.39.31:8080/wps/upload_l.jsp", "aa不落地测试.doc" );
      alert(aa);
	}
	   function saveAsBase64Str()
   {
   	base64str_wps= app.saveAsBase64Str("ofd");
       alert(base64str_wps);
   }

	function openDocumentFromBase64Str()
	{
		if(typeof base64str_wps != "undefined" && base64str_wps != "")
		{
			var aa = app.openDocumentFromBase64Str(base64str_wps, false);
			alert (aa);
               }
	       else{
               		alert("请先调用saveasbase64str");
               }
	} 

	//手写批注相关接口
	
	function EnterInkDraw() 
{
        aa = app.EnterInkDraw();
	alert(aa);
    }
	
	function ExitInkDraw() 
{
        aa = app.ExitInkDraw();
	alert(aa);
    }
    function SetInkDrawColor() 
{
        aa = app.SetInkDrawColor("#BBFFFF");
	alert(aa);
    }
	
	function SetInkDrawStyle1() {
        aa = app.SetInkDrawStyle(0);
	alert(aa);
    }
	function SetInkDrawStyle2() {
        aa = app.SetInkDrawStyle(1);
	alert(aa);
    }
	
	function SetInkDrawShapeStyle1()
 {
        aa = app.SetInkDrawShapeStyle(0);
	alert(aa);
    }
	function SetInkDrawShapeStyle2()
 {
        aa = app.SetInkDrawShapeStyle(1);
 	alert(aa);
    }
	function SetInkDrawShapeStyle3()
{
       aa =  app.SetInkDrawShapeStyle(2);
	alert(aa);
    }
	
	function SetInkDrawPenStyle1() 
{
        aa = app.SetInkDrawPenStyle(0);
	alert(aa);
    }
	function SetInkDrawPenStyle2() 
{
        aa = app.SetInkDrawPenStyle(1);
	alert(aa);
    }
	function SetInkDrawPenStyle3()
 {
        aa = app.SetInkDrawPenStyle(2);
	alert(aa);
    }
	
	function SetInkDrawLineStyle1() 
{
        aa = app.SetInkDrawLineStyle(0);
	alert(aa);
    }
	
	function SetInkDrawLineStyle2() 
{
        aa = app.SetInkDrawLineStyle(4);
	alert(aa);
    }
	function SetInkDrawLineStyle3() 
{
        aa = app.SetInkDrawLineStyle(8);
	alert(aa);
    }
	
	function SetInkDrawEraser() 
{
        aa = app.SetInkDrawEraser(true);
	alert(aa);
    }
	function SetInkDrawEraser2()
 {
        aa = app.SetInkDrawEraser(false);
	alert(aa);
    }
	function InsertImageFromScanner()
 {
        aa = app.InsertImageFromScanner();
	alert(aa);
    }

    function CommandBarsT()
{
	var aa = app.ActiveDocument.CommandBars.get_Item("File").Controls.get_Item("转换(&B)").Visible=true;
    alert(aa);
	}
    function CommandBarsF()
{
	var aa = app.ActiveDocument.CommandBars.get_Item("File").Controls.get_Item("转换(&B)").Visible=false;
    alert(aa);
	}
    function Documents()
{
	var aa = app.Documents.Open("/home/wps/桌面/001.wps", false, false, false, "", "", false, "", "", 0, 0, false, false,  false, 0, false);
    alert(aa);
	}
 function retitle1()
{
	var aa = app.Selection.Rows.put_HeadingFormat(1);
    alert(aa);
	}
 function retitle2()
{
	var aa = app.Selection.Rows.put_HeadingFormat(0);
    alert(aa);
	}

	/*
		auth: zhangpeng
		date: 2019-02-19
		params: [IN] [object] Doc 当前文档对象，即Document对象
				[IN] [object] SaveAsUI 代表是否是另存为，true为另存为，false为保存，该对象调用GetValue()
				[OUT] [object] Cancel 代表是否要取消当前保存操作，true取消，false正常保存，该对象调用SetValue()
		description: wps触发文档保存事件的消息回调
	*/
	function DocumentBeforeSaveCallBack(Doc, SaveAsUI, Cancel) {
		// ××××××××在此函数中调用保存操作不会再次触发保存回调×××××××××
		// 如果打开文档对象和传入对象不一致，则什么都不做（主要是预加载有问题）
		 if (documentTmp != Doc) {
		 return;
		}
		var ui = SaveAsUI.GetValue();
		if (ui) {
			// 代表当前会弹出保存窗口，即另存为操作。
		} else {
			// 代表当前不会弹出保存窗口，即保存操作。
		}

		// 如果该值设置为true，则表示取消当前保存操作，无论如何不会弹出另存为对话框。
		//Cancel.SetValue(true);
		//console.log("Ctrl+S快捷键监控");
		// 如果该值设置为false，则表示正常保存，不影响对话框的显示与否。
	     Cancel.SetValue(false);
		 alert("保存监控");
	}

	/*
		auth: zhangpeng
		date: 2019-02-19
		params: nothing
		result: [bool] true为注册成功，fasle为注册失败。
		description: 注册文档保存事件
	*/
	function RegisterDocumentBrforeSaveEvent() {
		var app = obj.Application;
		var ret = app.registerEvent("DIID_ApplicationEvents4", "DocumentBeforeSave", "DocumentBeforeSaveCallBack");
		alert("监控");		
		return ret;
	}
	function unRegisterDocumentBrforeSaveEvent() {
		var app = obj.Application;
		var ret = app.unregisterEvent("DIID_ApplicationEvents4", "DocumentBeforeSave", "DocumentBeforeSaveCallBack");
		alert("取消监控");		
		return ret;
	}
	function insertMultiBookMarks()
	{
		var a = app.insertMultiBookMarks("book1,book2,book3,book4",",");
		alert(a);
		
	}

	function deleteMultiBookMarks()
	{
		var a = app.deleteMultiBookMarks("book1,book2,book3,book4",",");
		alert(a);
	}

	function getAllBookMarks()
	{
		alert(app.getAllBookMarks());
	}

	function replaceBookMarksText()
	{
		var a = app.replaceBookMarksText("book1,book2,book3,book4","1111,2222,33333,44444",",", ",");
		alert(a);
	}
	 
	function saveURL_GetData()
	{
		var aa = app.saveURL_GetData("http://192.168.39.31:8080/wps/upload_l.jsp", "test.wps");
		alert(aa);
	}

	var wpsIsProtect = 0;

	function DocumentBeforeSaveCallBackUnprotect(Doc, SaveAsUI, Cancel) 
	{
		wpsIsProtect = Doc.ProtectionType;
		if (wpsIsProtect == 3)
		{
			Doc.Unprotect();
		}
		console.log("DocumentBeforeSaveCallBackUnprotect:"+ wpsIsProtect);
	}
	function RegisterDocumentBeforeSaveEventUnprotect() 
	{
		var app = obj.Application;
		var ret = app.registerEvent("DIID_ApplicationEvents4", "DocumentBeforeSave", "DocumentBeforeSaveCallBackUnprotect");
		console.log("RegisterDocumentBeforeSave:" +ret);		
	}
 
	function EventCallBackAfterSaveProtect(doc, saveResult) 
	{ 
		if (wpsIsProtect == 3)
		{
			console.log("AfterSave:" +doc.Protect(wpsIsProtect, true));
			wpsIsProtect = 0;
		}
		console.log("AfterSave----");
	} 
	function RegisterAfterSaveEvent() 
	{ 
		var appex = obj.Application.ApplicationEx; 
		var ret = appex.registerEvent("DIID_WpsApplicationEventsEx","DocumentAfterSave","EventCallBackAfterSaveProtect"); 
		console.log("RegisterAfterSave--"+ret); 
	}
	 
	function UnRegisterAfterSaveEvent() 
	{ 
		var appex = obj.Application.ApplicationEx; 
		var ret = appex.unRegisterEvent("DIID_WpsApplicationEventsEx","DocumentAfterSave","EventCallBackAfterSaveProtect"); 
		console.log("UnRegisterAfterSave--"+ret); 
	}
	function RegisterSaveEvent() 
	{ 
		obj.Application.ApplicationEx.put_SaveRememberStatus(false);//true，代表另存后当前显示文档为另存得到的新文档；false，代表另存后当前显示文档为原文档
		RegisterDocumentBeforeSaveEventUnprotect();
		RegisterAfterSaveEvent();
	}
	function SplitRow()
	{
			try
		{
			var tb = app.ActiveDocument.Tables.Item(1);
			//alert(tb.Rows.get_Count());
			var row = tb.Rows.Item(1);
			//alert(row.Cells.get_Count());
			row.Cells.Split(3,2);
		}
		catch(err)
		{
			err:exception;
		}
	}
	function SplitColumn()
	{
			try
		{
			var tb = app.ActiveDocument.Tables.Item(1);
			//alert(tb.Columns.get_Count());
			var columns = tb.Columns.Item(2);
			//alert(columns.Cells.get_Count());
			aa=columns.Cells.Split(10, 13);
			//alert(columns.Cells.Item(1));
			//alert(aa);
		}
		catch(err)
		{
			err:exception;
		}
	}
	function SplitCell()
	{
			try
		{
			var tb = app.ActiveDocument.Tables.Item(1);
			alert(tb.Rows.get_Count());
			var row = tb.Rows.Item(2);
			alert(row.Cells.get_Count());
			aa=row.Cells.Item(1).Split(2,3);
			alert(aa);
		}
		catch(err)
		{
			err:exception;
		}
	}
	

</script>




